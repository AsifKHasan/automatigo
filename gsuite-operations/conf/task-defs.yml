# ------------------------------------------------
# cell linking and ordering
# ------------------------------------------------

# link_cells_to_drive_files:
link_cells_to_drive_files:
  task                                        : link_cells_to_drive_files
  worksheet_name                              : 'files-folders'
  range_specs_for_cells_to_link               :
  - 'F3:F'

# link_cells_based_on_type
link_cells_based_on_type:
  task                                        : link_cells_based_on_type
  worksheet_name                              : '-toc'
  range_specs_for_cells_to_link               :
  - 'E3:F'

# link_cells_to_worksheet
link_cells_to_worksheet:
  task                                        : link_cells_to_worksheet
  worksheet_name                              : '-toc'
  range_specs_for_cells_to_link               :
    # - 'M3:M'
    # - 'N3:N'
    - 'R3:R'
    - 'S3:S'
    - 'T3:T'
    - 'U3:U'
    - 'V3:V'
    - 'W3:W'

# order_worksheets
order_worksheets:
  task                                        : order_worksheets



# ------------------------------------------------
# worksheet duplication, removal, renaming
# ------------------------------------------------

# duplicate_worksheet
duplicate_worksheet:
  task                                        : duplicate_worksheet
  worksheet_names                             : true
  worksheet_name_to_duplicate                 : 'z-blank'
  match_worksheet_names                       : false

# remove_worksheets
remove_worksheets:
  task                                        : remove_worksheets
  worksheet_names                             : true

# rename_worksheet
rename_worksheet:
  task                                        : rename_worksheet
  worksheet_name                              : '-toc-new'
  new_worksheet_name                          : '-toc'

rename_worksheet__z-header:
  task                                        : rename_worksheet
  worksheet_name                              : 'z-header'
  new_worksheet_name                          : 'z-head'

rename_worksheet__z-footer:
  task                                        : rename_worksheet
  worksheet_name                              : 'z-footer'
  new_worksheet_name                          : 'z-foot'

# copy_worksheets_to_other_gsheets
copy_worksheets_to_other_gsheets:
  task                                        : copy_worksheets_to_other_gsheets
  worksheet_names                             : true
  destination_gsheet_names:



# ------------------------------------------------
# worksheet creation, formatting and related tasks
# ------------------------------------------------

# clear_data_validations
clear_data_validations:
  task                                        : clear_data_validations
  worksheet_names                             : true
  range_spec                                  : 'A1:AZ'

# clear_conditional_formats
clear_conditional_formats:  
  task                                        : clear_conditional_formats
  worksheet_names                             : true

# create_review_notes_conditional_formatting
create_review_notes_conditional_formatting:  
  task                                        : create_review_notes_conditional_formatting
  worksheet_names                             : true

# create_worksheets
create_worksheets:  
  task                                        : create_worksheets
  worksheet_names                             : true
  match_worksheet_names                       : false
  worksheet_defs:

# format_worksheets
format_worksheets:  
  task                                        : format_worksheets
  worksheet_names                             : true
  match_worksheet_names                       : false
  worksheet_defs:



# ------------------------------------------------
# trailing blank row removal, review-notes, column sizing
# ------------------------------------------------

# report_dimensions
report_dimensions:
  task                                        : report_dimensions
  worksheet_names                             : true

# move_column
move_column:
  task                                        : move_column
  worksheet_name                              : '-toc'
  move_from                                   : 'K'
  move_to                                     : 'L'
  check_condition                             : true
  conditions:
    - cell_a1                                 : 'K2'
      operator                                : '=='
      value_is                                : 'hide-pageno'

# remove_columns
remove_columns:
  task                                        : remove_columns
  worksheet_name                              : '-toc'
  cols_to_remove_from                         : 'AE'
  cols_to_remove_to                           : 'AE'
  check_condition                             : true
  conditions:
    - method                                  : num_cols
      operator                                : '=='
      value_is                                : 31
    - cell_a1                                 : 'AE2'
      operator                                : '=='
      value_is                                : ''

# remove_trailing_blank_rows
remove_trailing_blank_rows:
  task                                        : remove_trailing_blank_rows
  worksheet_names                             : true

# column_pixels_in_row
column_pixels_in_row:
  task                                        : column_pixels_in_row
  worksheet_names                             : true
  row_to_update                               : 1

# resize_columns_from_values_in_row
resize_columns_from_values_in_row:
  task                                        : resize_columns_from_values_in_row
  worksheet_names                             : true
  row_to_consult                              : 1

# order_columns
order_columns:
  task                                        : order_columns
  worksheet_name                              : '-toc'
  row_to_consult                              : 2
  order_by_values:
  - 'section'
  - 'heading'
  - 'process'
  - 'level'
  - 'content-type'
  - 'link'
  - 'break'
  - 'page-spec'
  - 'margin-spec'
  - 'landscape'
  - 'heading-style'
  - 'bookmark'
  - 'jpeg-quality'
  - 'page-list'
  - 'autocrop'
  - 'page-bg'
  - 'hide-heading'
  - 'header-first'
  - 'header-odd'
  - 'header-even'
  - 'footer-first'
  - 'footer-odd'
  - 'footer-even'
  - 'override-header'
  - 'override-footer'
  - 'background-image'
  - 'responsible'
  - 'reviewer'
  - 'status'
  - 'comment'



# ------------------------------------------------
# add rows and columns
# ------------------------------------------------

# add_rows
add_rows:
  task                                        : add_rows
  worksheet_names                             : true
  rows_to_add_at                              : end
  rows_to_add                                 : 1
  when_row_count_is                           : 15

# add_columns
add_columns:
  task                                        : add_columns
  worksheet_names                             : true
  cols_to_add_at                              : 'L'
  cols_to_add                                 : 3
  when_col_count_is                           : 27



# ------------------------------------------------
# find and replace in worksheets
# ------------------------------------------------

# find_and_replace
find_and_replace:
  task                                        : find_and_replace
  worksheet_names                             : true
  find_replace_patterns:
    # z-header
    - find                : 'z-header'
      replace-with        : 'z-head'
      regex               : False
      include-formulas    : True
      entire-cell         : False
      match-case          : True

    # z-footer
    - find                : 'z-footer'
      replace-with        : 'z-foot'
      regex               : False
      include-formulas    : True
      entire-cell         : False
      match-case          : True



# ------------------------------------------------
# work on ranges etc.
# ------------------------------------------------

# work_on_ranges
work_on_ranges:
  task                                        : work_on_ranges
  worksheet_names                             : true
  check_condition                             : false
  conditions:
    - method                                  : num_cols
      operator                                : '=='
      value_is                                : 30
  work_specs:
    # custom formats
      # 'A1:Z':
      #   font-family:                    Arial
      #   font-size:                      10
      #   valign:                         top
      # 'A1':
      #     value:                        '-toc'
      #     ws-name-to-link:              '-toc'
      #     halign:                       left
    # update row 1 for column sizes
      # 'A1':
      #   'value':  60
      # 'B1':
      #   'value':  300
      # 'C1':
      #   'value':  80
      # 'D1':
      #   'value':  80
      # 'E1':
      #   'value':  80
      # 'F1':
      #   'value':  200
      # 'G1':
      #   'value':  80
      # 'H1':
      #   'value':  80
      # 'I1':
      #   'value':  100
      # 'J1':
      #   'value':  80
      # 'K1':
      #   'value':  80
      # 'L1':
      #   'value':  80
      # 'M1':
      #   'value':  80
      # 'N1':
      #   'value':  80
      # 'O1':
      #   'value':  80
      # 'P1':
      #   'value':  80
      # 'Q1':
      #   'value':  80
      # 'R1':
      #   'value':  80
      # 'S1':
      #   'value':  80
      # 'T1':
      #   'value':  80
      # 'U1':
      #   'value':  80
      # 'V1':
      #   'value':  80
      # 'W1':
      #   'value':  80
      # 'X1':
      #   'value':  80
      # 'Y1':
      #   'value':  80
      # 'Z1':
      #   'value':  100
      # 'AA1':
      #   'value':  80
      # 'AB1':
      #   'value':  80
      # 'AC1':
      #   'value':  160
      # 'AD1':
      #   'value':  300
    # data validations
      # 'C3:C':
      #   validation-list:
      #     - 'Yes'
      # 'D3:D':
      #   validation-list:
      #     - '0'
      #     - '1'
      #     - '2'
      #     - '3'
      #     - '4'
      #     - '5'
      #     - '6'
      # 'E3:E':
      #   validation-list:
      #     - table
      #     - pdf
      #     - gsheet
      #     - toc
      #     - lof
      #     - lot
      # 'G3:G':
      #   validation-list:
      #     - page
      #     - section
      # 'H3:H':
      #   validation-list:
      #     - A4
      #     - A3
      #     - Letter
      #     - Legal
      # 'I3:I':
      #   validation-list:
      #     - wide
      #     - medium
      #     - narrow
      #     - none
      #     - book-bind
      #     - secl-pad
      #     - doer-pad
      #     - stamp
      #     - narrow-no-header
      #     - narrow-no-footer
      #     - narrow-no-header-footer
      # 'J3:J':
      #   validation-list:
      #     - 'Yes'
      # 'O3:O':
      #   validation-list:
      #     - 'Yes'
      # 'P3:P':
      #   validation-list:
      #     - 'Yes'
      # 'Q3:Q':
      #   validation-list:
      #     - 'Yes'
      # 'X3:X':
      #   validation-list:
      #     - 'Yes'
      # 'Y3:Y':
      #   validation-list:
      #     - 'Yes'
      # 'AC3:AC':
      #   validation-list:
      #     - pending
      #     - under-documentation
      #     - ready-for-review
      #     - under-review
      #     - finalized
    # conditional formats
      # 'AA3:AA':
      #   conditional-formats:
      #     - type:               'BLANK'
      #       values: 
      #       format:
      #         backgroundColor : "#fff2cc"
      # 'AB3:AB':
      #   conditional-formats:
      #     - type:               'BLANK'
      #       values: 
      #       format:
      #         backgroundColor : "#fff2cc"
      # 'AC3:AC':
      #   conditional-formats:
      #     - type:               'BLANK'
      #       values: 
      #       format:
      #         backgroundColor : "#fff2cc"
